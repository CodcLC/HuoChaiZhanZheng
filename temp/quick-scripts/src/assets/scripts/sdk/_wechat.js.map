{"version":3,"sources":["assets\\scripts\\sdk\\_wechat.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { param } from \"./type\";\n\nvar TAG = '_wechat.ts';\nclass _wechat {\n    private static Instance: _wechat = null;\n    private videoAd: any = null;\n    private bannerAd: any = null;\n    private videoId: string = \"\";\n    private bannerId: string = \"\";\n    private insertId: string = \"\";\n    private sdkInitEnd: boolean = false;\n    private onVideoAdCallBack: Function = null;\n    private insertAdTime = 0;\n    constructor() {\n        console.log(TAG, 'init platform channel: _wechat');\n    }\n    public static getInstance(): _wechat {\n        if (this.Instance == null) {\n            this.Instance = new _wechat();\n        }\n        return this.Instance;\n    }\n    initAdParams(param: param) {\n        if (this.sdkInitEnd) {\n            return;\n        }\n        this.sdkInitEnd = true;\n        this.insertId = param.insertId;\n        this.bannerId = param.bannerId;\n        this.videoId = param.videoId;\n    }\n    initBannerAd() {\n        // @ts-ignore\n        const { windowWidth, windowHeight } = wx.getSystemInfoSync();\n        var targetBannerAdWidth = 120;\n        // 创建一个居于屏幕底部正中的广告\n        // @ts-ignore\n        this.bannerAd = wx.createBannerAd({\n            adUnitId: this.bannerId,\n            adIntervals: 120,\n            style: {\n                width: targetBannerAdWidth,\n                top: windowHeight - (targetBannerAdWidth / 16 * 9), // 根据系统约定尺寸计算出广告高度\n            }\n        });\n        this.bannerAd.onError((err: any) => {\n            switch (err['errCode']) {\n                case 1000:\n                    console.warn(TAG, '后端错误调用失败');\n                    break;\n                case 1001:\n                    console.warn(TAG, '参数错误');\n                    break;\n                case 1002:\n                    console.warn(TAG, '广告单元无效');\n                    break;\n                case 1003:\n                    console.warn(TAG, '内部错误');\n                    break;\n                case 1004:\n                    console.warn(TAG, '无合适的广告, 尝试重新加载');\n                    break;\n                case 1005:\n                    console.warn(TAG, '广告正在被审核，无法展现广告');\n                    break;\n                case 1007:\n                    console.warn(TAG, '广告能力被禁用');\n                    break;\n                case 1008:\n                    console.warn(TAG, '广告单元已关闭');\n                    break;\n                default:\n                    break;\n            }\n        });\n        // 也可以手动修改属性以调整广告尺寸\n        this.bannerAd.style.left = (windowWidth - targetBannerAdWidth) / 2;\n        // 尺寸调整时会触发回调\n        // 注意：如果在回调里再次调整尺寸，要确保不要触发死循环！！！\n        this.bannerAd.onResize((size: any) => {\n            console.log(TAG, size.width, size.height);\n            if (size.width == 0 || size.height == 0) {\n                return;\n            }\n            // 如果一开始设置的 banner 宽度超过了系统限制，可以在此处加以调整\n            if (targetBannerAdWidth != size.width) {\n                targetBannerAdWidth = size.width;\n                this.bannerAd.style.top = windowHeight - (size.height);\n                this.bannerAd.style.left = (windowWidth - size.width) / 2;\n            }\n        });\n        //广告组件成功拉取广告素材时会触发load事件的监听器\n        this.bannerAd.onLoad(function () {\n            console.log(TAG, \"banner广告拉取完成!\");\n        });\n    }\n    bannerAd_show() {\n        if (this.bannerAd) {\n            this.bannerAd.show();\n        }\n    }\n    bannerAd_hide() {\n        if (this.bannerAd) {\n            this.bannerAd.hide();\n            this.initBannerAd();\n        }\n    }\n    initVideoAd() {\n        //@ts-ignore\n        if (wx.createRewardedVideoAd) {\n            return;\n        }\n        //@ts-ignore\n        this.videoAd = wx.createRewardedVideoAd({\n            adUnitId: this.videoId,\n            multiton: false\n        });\n        this.videoAd.onClose((res: any) => {\n            if (res && res.isEnded) {\n                this.onVideoAdCallBack(true);\n            } else {\n                this.onVideoAdCallBack(false);\n            }\n        });\n        this.videoAd.onError((err: any) => {\n            switch (err.errCode) {\n                case 1000:\n                    console.warn(TAG, `后端接口调用失败`);\n                    break;\n                case 1001:\n                    console.warn(TAG, `参数错误`);\n                    break;\n                case 1002:\n                    console.warn(TAG, `广告单元无效`);\n                    break;\n                case 1003:\n                    console.warn(TAG, `内部错误`);\n                    break;\n                case 1004:\n                    console.warn(TAG, `无合适的广告`);\n                    break;\n                case 1005:\n                    console.warn(TAG, `广告组件审核中`);\n                    break;\n                case 1006:\n                    console.warn(TAG, `广告组件被驳回`);\n                    break;\n                case 1007:\n                    console.warn(TAG, `广告组件被封禁`);\n                    break;\n                case 1008:\n                    console.warn(TAG, `广告单元已关闭`);\n                    break;\n            }\n        });\n        this.videoAd.onLoad((res: any) => {\n            this.videoAd.show();\n        });\n        this.videoAd.load();\n    }\n    videoAd_show(onVideoCall: Function) {\n        this.onVideoAdCallBack = onVideoCall;\n        this.videoAd != null ? this.videoAd.load() : this.initVideoAd();\n    }\n    insterAd_show() {\n        let time = new Date().getTime();\n        if (time - this.insertAdTime < 30000) {\n            console.log(TAG, '广告冷却中...');\n            return;\n        }\n        this.insertAdTime = time;\n        //@ts-ignore\n        let interstitialAd = tt.createInterstitialAd({\n            adUnitId: this.insertId\n        });\n        interstitialAd.onError((err: any) => {\n            switch (err.errCode) {\n                case 1000:\n                    console.warn(TAG, `后端接口调用失败`);\n                    break;\n                case 1001:\n                    console.warn(TAG, `参数错误`);\n                    break;\n                case 1002:\n                    console.warn(TAG, `广告单元无效`);\n                    break;\n                case 1003:\n                    console.warn(TAG, `内部错误`);\n                    break;\n                case 1004:\n                    console.warn(TAG, `无合适的广告`);\n                    break;\n                case 1005:\n                    console.warn(TAG, `广告组件审核中`);\n                    break;\n                case 1006:\n                    console.warn(TAG, `广告组件被驳回`);\n                    break;\n                case 1007:\n                    console.warn(TAG, `广告组件被封禁`);\n                    break;\n                case 1008:\n                    console.warn(TAG, `广告单元已关闭`);\n                    break;\n            }\n        });\n        interstitialAd.onClose(() => {\n            interstitialAd.destroy();\n        });\n        interstitialAd.load().then(() => {\n            interstitialAd.show();\n        });\n    }\n}\nexport const ch_wechat = _wechat;"]}