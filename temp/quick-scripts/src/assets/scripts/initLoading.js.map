{"version":3,"sources":["assets\\scripts\\initLoading.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport { Export } from \"../syyx_sdk/export_sdk\";\nimport { syyx_sdk_api } from \"../syyx_sdk/syyx_sdk_api\";\nimport { caijiTools } from \"./caijiTools\";\nimport { ad } from \"./sdk/ad\";\nimport { data } from \"./sdk/data\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class initLoading extends cc.Component {\n\n    successNum:number=0;\n    // bundleName:string[]=[\"mainUi\",\"prefabs\",\"game\",\"sp_enemy\",\"sp_others\",\"sp_player\",\"sounds\"];\n    bundleName:string[]=[\"game\",\"sp_enemy\",\"sp_others\",\"sounds\"];\n\n    actionTime:number=1;\n    version:string=\"1.0.1\";\n\n    start () {\n        data.init(false).then(()=>{\n            this.addNewData();\n            // this.unlockAllLevel();\n        });\n        // if (cc.sys.isBrowser){\n        //     ad.init(true);\n        // }else\n        {\n            ad.init(false);\n        }\n\n        this.loadBundle();\n\n        this.initSDK()\n    }\n\n\n    public initSDK() {\n        console.log(\"init SDK....\")\n        syyx_sdk_api.init(function (ret, param) {\n            if (ret === true) {\n                if (param.load_init_complete) {}\n                if (param.load_local_complete) {\n                    //本地配置加载完成\n                    setTimeout(() => {\n                        Export.preload_YSAD(\"10304001\") // 预加载原生banner\n                    }, 600); \n                }\n                if (param.load_remote_complete) {\n                    //远端配置拉取完毕\n                    console.log(\"sdk-----business_config data:\" + JSON.stringify(param.business_config)); \n                }\n            }\n        }.bind(this))\n    }\n    \n    \n    unlockAllLevel(){\n        for(let i=0;i<20;i++){\n            data.updateCache(\"levelUnlock\",i.toString(),1)\n        }\n    }\n    loadBundle(){\n        let self=this;\n        for(let name of this.bundleName){\n            caijiTools.loadBundlePackage(name,(successName)=>{\n                self.successNum++;\n                if(self.successNum==self.bundleName.length){\n                    if(cc.director.getTotalTime()<1000){\n                        this.scheduleOnce(()=>{\n                            this.enterMain();\n                        },0.5);\n                    }else{\n                        this.enterMain();\n                    }\n                }\n            });\n        }\n    }\n    enterMain(){\n        for(let child of this.node.children){\n            if(child.childrenCount!=0){\n                cc.tween(child.children[0])\n                .to(this.actionTime,{color:cc.color(0,0,0)})\n                .start();\n            }\n            cc.tween(child)\n            .to(this.actionTime,{color:cc.color(0,0,0)})\n            .start();\n        }\n        this.scheduleOnce(()=>{\n            cc.director.loadScene(\"main\");\n        },this.actionTime);\n    }\n    addNewData(){\n        if(data.getCache(\"Base\",\"version\")==this.version) return;\n        data.updateCache(\"Base\",\"version\",this.version);\n    }\n}\n"]}