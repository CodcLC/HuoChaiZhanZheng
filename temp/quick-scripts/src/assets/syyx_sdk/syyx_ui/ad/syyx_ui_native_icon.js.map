{"version":3,"sources":["assets\\syyx_sdk\\syyx_ui\\ad\\syyx_ui_native_icon.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { e_ad_id } from './../../configs/syyx_sdk_enum';\r\nimport { syyx_const } from \"../../configs/syyx_sdk_config\";\r\nimport { syyx_manager } from \"../../controller/syyx_manager\";\r\nimport { native_ad_data } from \"../../model/model\";\r\nimport { syyx_sdk_api } from \"../../syyx_sdk_api\";\r\nimport { syyx_sdk_utils } from \"../../utils/syyx_sdk_utils\";\r\nimport { syyx_adv_manager } from '../../controller/ad/syyx_adv_manager';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class syyx_ui_native_icon extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    icon_close: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    native_node: cc.Node = null;\r\n\r\n    @property(cc.Sprite)\r\n    img_icon: cc.Sprite = null;\r\n\r\n    /**\r\n     * 原生广告数据\r\n     */\r\n    native_data: native_ad_data\r\n\r\n    constructor() {\r\n        super()\r\n\r\n        this.set_background_on_show()\r\n    }\r\n\r\n    on_click_adv() {\r\n        this.report_click();\r\n    }\r\n\r\n    on_click_close() {\r\n        let _business_config_data = syyx_manager.get_business_config()\r\n        if (_business_config_data && _business_config_data[\"native_icon_trap_pro\"]) {\r\n            let trap_pro = _business_config_data[\"native_icon_trap_pro\"].value[0] // 0\r\n            if (trap_pro >= 0 && Math.random() <= trap_pro) { // trap_pro为0，不满足条件\r\n                this.report_click()\r\n            }\r\n        }\r\n        this.hide();\r\n    }\r\n\r\n    /**\r\n    * 广告被点击\r\n    */\r\n    report_click() {\r\n        if (this.native_data) {\r\n            syyx_adv_manager.report_ad_click(e_ad_id.native_icon, this.native_data)\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 广告被曝光\r\n    */\r\n    report_show() {\r\n        if (this.native_data) {\r\n            syyx_adv_manager.report_ad_show(e_ad_id.native_icon, this.native_data)\r\n        }\r\n    }\r\n\r\n    show(parent, native_data) {\r\n        if (this.node && !this.node.parent && parent) {\r\n            this.native_data = native_data\r\n            this.node.parent = parent\r\n            this.on_show();\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 上报点击后  重新拉取原生数据刷新界面\r\n    */\r\n    report_click_update_view(native_data) {\r\n        if (this.node && this.node.parent) {\r\n            this.native_data = native_data\r\n            this.refresh()\r\n        }\r\n    }\r\n\r\n    on_show() {\r\n        this.icon_close.on(cc.Node.EventType.TOUCH_END, this.on_click_close, this)\r\n        this.img_icon.node.on(cc.Node.EventType.TOUCH_END, this.on_click_adv, this)\r\n        this.refresh()\r\n    }\r\n\r\n    refresh() {\r\n        syyx_sdk_utils.set_texture_url(this.img_icon, this.native_data.imgUrlList, this.hide.bind(this))\r\n        this.report_show()\r\n        this.play_icon_animation()\r\n    }\r\n\r\n    icon_ani\r\n    private play_icon_animation() {\r\n        this.stop_icon_animation()\r\n        this.native_node.rotation = 0\r\n        let move1 = cc.rotateTo(0.2, -5)\r\n        let move2 = cc.rotateTo(0.4, 5)\r\n        let move3 = cc.rotateTo(0.2, 0)\r\n        this.icon_ani = this.native_node.runAction(cc.sequence(move1, move2, move3))\r\n    }\r\n\r\n\r\n    private stop_icon_animation() {\r\n        if (this.icon_ani) {\r\n            this.native_node.stopAction(this.icon_ani)\r\n            this.icon_ani = null\r\n        }\r\n    }\r\n\r\n    hide() {\r\n        if (this.node && this.node.parent) {\r\n            this.node.parent.removeChild(this.node)\r\n            this.on_hide();\r\n        }\r\n    }\r\n\r\n    on_hide() {\r\n        this.icon_close.off(cc.Node.EventType.TOUCH_END, this.on_click_close, this)\r\n        this.img_icon.node.off(cc.Node.EventType.TOUCH_END, this.on_click_adv, this)\r\n    }\r\n\r\n    set_default_pos(style) {\r\n\r\n    }\r\n\r\n    set_style_pos(x, y) {\r\n\r\n    }\r\n\r\n    set_background_on_show() {\r\n        let self = this\r\n        if (syyx_const.syyx_sdk_channel === igc.e_channel_type.hw_qg) {\r\n            //后台到前台\r\n            syyx_sdk_api.on_show(\r\n                function () {\r\n                    if (self && cc.isValid(self.node)) {\r\n                        console.log(\"igc----- native_icon set_background_on_show\")\r\n                        self.report_show()\r\n                    }\r\n                }\r\n            )\r\n        }\r\n    }\r\n}\r\n"]}