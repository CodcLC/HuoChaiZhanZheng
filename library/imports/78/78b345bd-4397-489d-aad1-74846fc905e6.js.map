{"version":3,"sources":["assets\\scripts\\game\\GameManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport { Export } from \"../../syyx_sdk/export_sdk\";\nimport { syyx_sdk_api } from \"../../syyx_sdk/syyx_sdk_api\";\nimport { caijiTools } from \"../caijiTools\";\nimport audioManager from \"../main/audioManager\";\nimport { ad } from \"../sdk/ad\";\nimport { data } from \"../sdk/data\";\nimport coinDrop from \"./coinDrop\";\nimport damageTipPool from \"./damageTipPool\";\nimport enemySpawn from \"./enemySpawn\";\nimport Events from \"./Events\";\nimport playerController from \"./playerController\";\nimport playerSpawn from \"./playerSpawn\";\nimport uiManager from \"./ui/uiManager\";\n\nconst {ccclass, property} = cc._decorator;\nenum MapName{\n    Map1_bambooForest1,\n    Map2_bambooForest2,\n    Map3_OldVillage1,\n    Map4_OldVillage2,\n    Map5_OldState1,\n    Map6_OldState2\n}\n@ccclass\nexport default class GameManager extends cc.Component {\n\n    map:cc.Node=null;\n    player:cc.Node=null;\n    playerController:playerController=null;\n    playerSpawnM:playerSpawn=null;\n    enemySpawnM:enemySpawn=null;\n    needKillEnemyAmount:number=0;\n    killEnemyAmoun:number=0;\n    dropCoins:cc.Node[]=[];\n    static instance:GameManager=null;\n    onLoad () {\n        GameManager.instance=this;\n        damageTipPool.instance.init();\n        caijiTools.openPhysicsSystem(0,false);       \n    }\n\n    onDisable(){\n        audioManager.pauseBgGame();\n    }\n    start () {\n        ad.record();\n        audioManager.playBgGame();\n        this.init();\n    }\n    init(){\n        let level=Number(data.getCache(\"Base\",\"choseLevel\"));\n        let mapIndex=Number(data.gameJson(\"levelData\",level.toString(),\"map\"));\n        this.loadMap(MapName[mapIndex]);\n        Events.instance.init();\n    }\n    //计数（击杀怪物）\n    killEnemyCount(){\n        this.killEnemyAmoun++;\n        console.log(\"怪物技术\",this.killEnemyAmoun,this.needKillEnemyAmount)\n        if(this.killEnemyAmoun==this.needKillEnemyAmount){\n            uiManager.ins.win();\n        }\n    }\n    pickUpCoin(){\n        for(let coin of this.dropCoins){\n            coin.getComponent(coinDrop).startMoveToPlayer();\n        }\n        this.dropCoins=[];\n    }\n    async loadMap(mapName:string){\n        let pre=await caijiTools.loadPrefab(\"prefabs/maps/\"+mapName);\n        this.map=caijiTools.createNode(pre,this.node.parent);\n        this.map.setSiblingIndex(this.node.getSiblingIndex());\n        uiManager.ins.loadingEnd();\n    }\n    spawnPlayer(){\n        this.playerSpawnM.spawnPlayer();\n    }\n    createSpawnEnemy(enemyName:string,parent:cc.Node,position:cc.Vec2){\n        Events.instance.createSpawnEnemyEffect(enemyName,parent,position);\n    }\n    spawnEnemy(enemyName:string,parent:cc.Node,position:cc.Vec2){\n        Events.instance.spawnEnemy(enemyName,parent,position);\n    }\n    levelCompletEvent(){\n        //解锁当前关下一难度\n        let level=Number(data.getCache(\"Base\",\"choseLevel\"));\n        let difficulty=Number(data.getCache(\"levelStar\",(level).toString()))+1;\n        difficulty=difficulty>3?3:difficulty;\n        data.updateCache(\"levelStar\",level.toString(),difficulty);\n        //解锁下一关\n        if(level==100) return;\n        data.updateCache(\"levelUnlock\",level.toString(),1);\n    }\n}\n"]}