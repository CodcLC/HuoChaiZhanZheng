{"version":3,"sources":["assets\\scripts\\main\\audioManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport { audioName } from \"../audioNameMgr\";\nimport { caijiTools } from \"../caijiTools\";\nimport { data } from \"../sdk/data\";\n\nconst audioClipPath:string=\"sounds/\";\nconst {ccclass, property} = cc._decorator;\n@ccclass\nexport default class audioManager extends cc.Component {\n    @property(cc.SpriteFrame)\n    onSprite_audio:cc.SpriteFrame=null;\n    @property(cc.SpriteFrame)\n    offSprite_audio:cc.SpriteFrame=null;\n    @property(cc.Node)\n    soundSwitch:cc.Node=null;\n\n    isHaveBgm:boolean=true;\n    static audioNumber_bgMenu:number=-1;\n    static audioNumber_bgGame:number=-1;\n    static now_Volume:number=1;\n    static isAudioInit:boolean=false;\n    static instance:audioManager=null;\n    static audioClips:Map<string,cc.AudioClip>=new Map;\n    onLoad () {\n        audioManager.instance=this;\n        \n    }\n    start () {\n        this.init();\n    }\n    onDisable(){\n        this.bgOff();\n    }\n\n    onEnable() {        \n        if(audioManager.isAudioInit== false) return;\n        let soundOnOrOff = Number(data.getCache(\"Base\",\"sound\"));\n        cc.log(\"soundOnOrOff:\",soundOnOrOff)\n        if(audioManager.audioNumber_bgMenu==-1){            \n            if(soundOnOrOff==0){\n                cc.audioEngine.pause(audioManager.audioNumber_bgMenu);\n            }\n        }else{\n            if(soundOnOrOff==1){\n                cc.audioEngine.resume(audioManager.audioNumber_bgMenu);\n            }\n        }\n    }\n\n    async init(){\n        let bg:cc.AudioClip=null;\n        this.soundSwitch.active=true;\n        let soundOnOrOff=Number(data.getCache(\"Base\",\"sound\"));\n        this.soundSwitch.getComponent(cc.Sprite).spriteFrame=soundOnOrOff==0?this.offSprite_audio:this.onSprite_audio;\n        if(audioManager.isAudioInit==true) return;\n        audioManager.isAudioInit=true;\n        if(this.isHaveBgm==false) return;\n        if(audioManager.audioNumber_bgMenu==-1){\n            bg=await caijiTools.loadAudioClipBundle(\"sounds\",audioName.bgm_main);\n            let id=cc.audioEngine.play(bg, true,1 * audioManager.now_Volume);\n            audioManager.audioNumber_bgMenu=id;\n            if(soundOnOrOff==0){\n                cc.audioEngine.pause(audioManager.audioNumber_bgMenu);\n            }\n        }else{\n            if(soundOnOrOff==1){\n                cc.audioEngine.resume(audioManager.audioNumber_bgMenu);\n            }\n        }\n    }\n    bgOff(){\n        cc.audioEngine.pause(audioManager.audioNumber_bgMenu);\n    }\n    static async playBgGame(){\n        if(Number(data.getCache(\"Base\",\"sound\"))==0){\n        }else{\n            if(audioManager.audioNumber_bgGame==-1){\n                let bg=await caijiTools.loadAudioClipBundle(\"sounds\",audioName.bgm_game);\n                audioManager.audioNumber_bgGame=cc.audioEngine.play(bg, true,1 * audioManager.now_Volume);\n            }else{\n                cc.audioEngine.resume(audioManager.audioNumber_bgGame);\n            }\n        }\n    }\n    static pauseBgGame(){\n        if(audioManager.audioNumber_bgGame==-1) return;\n        cc.audioEngine.pause(audioManager.audioNumber_bgGame);\n    }\n    soundControl(){\n        if(audioManager.isAudioInit==false) return;\n        if(Number(data.getCache(\"Base\",\"sound\"))==0){\n            data.updateCache(\"Base\",\"sound\",1);\n            this.soundSwitch.getComponent(cc.Sprite).spriteFrame=this.onSprite_audio;\n            if(this.isHaveBgm)\n            cc.audioEngine.resume(audioManager.audioNumber_bgMenu);\n        }else{\n            data.updateCache(\"Base\",\"sound\",0);\n            this.soundSwitch.getComponent(cc.Sprite).spriteFrame=this.offSprite_audio;\n            if(this.isHaveBgm)\n            cc.audioEngine.pause(audioManager.audioNumber_bgMenu);\n        }\n    }\n/*     shockControl(){\n        if(Number(AppData.Instance.getCache(\"Base\",\"shock\"))==0){\n            AppData.Instance.updateCache(\"Base\",\"shock\",1);\n            this.shockSwitch.children[0].getComponent(cc.Sprite).spriteFrame=this.onSprite_shock;\n            audioManager.shock();\n        }else{\n            AppData.Instance.updateCache(\"Base\",\"shock\",0);\n            this.shockSwitch.children[0].getComponent(cc.Sprite).spriteFrame=this.offSprite_shock;\n        }\n    } */\n    static async playAudio(Name,isLoop:boolean=null,audioSize:number=null){\n        let onoff = Number(data.getCache(\"Base\",\"sound\")) \n        cc.log(\"playAudio onoff:\",onoff,cc.audioEngine.getMaxAudioInstance())\n        if(onoff == 1 ) {\n            let isloop=isLoop==null?false:isLoop;\n            let size=audioSize==null?1:audioSize;\n            if(audioManager.audioClips.get(Name)){\n                // let id = cc.audioEngine.play(audioManager.audioClips.get(Name), isloop,size * audioManager.now_Volume);\n                // cc.audioEngine.setFinishCallback(id,()=>{\n                //     cc.audioEngine.uncache(audioManager.audioClips.get(Name))\n                //     cc.log(\"playAudio cache uncache....\",Name,id)\n                // })\n                // cc.log(\"playAudio cache:\",Name,\"id:\",id,\",size:\",size,cc.audioEngine.getMaxAudioInstance())\n                return cc.audioEngine.play(audioManager.audioClips.get(Name), isloop,size * audioManager.now_Volume);                \n            }\n            \n            let AudioClip=await caijiTools.loadAudioClipBundle(\"sounds\",Name);\n            if (AudioClip){\n                audioManager.audioClips.set(Name,AudioClip);\n                // let id = cc.audioEngine.play(AudioClip, isloop,size * audioManager.now_Volume);    \n                // cc.audioEngine.setFinishCallback(id,()=>{\n                //     cc.audioEngine.uncache(audioManager.audioClips.get(Name))\n                //     cc.log(\"playAudio uncache....\",Name,id)\n                // })            \n                // cc.log(\"playAudio remote :\",Name,\"id:\",id,\",size:\",size,cc.audioEngine.getMaxAudioInstance())\n                return cc.audioEngine.play(AudioClip, isloop,size * audioManager.now_Volume);    \n            }else{\n                cc.log(\"playAudio load fail:\",Name)\n            }\n        }\n    }\n    static stopAudio(id:number){\n        cc.audioEngine.pause(id);\n    }\n    static shock(){\n        if(Number(data.getCache(\"Base\",\"shock\"))==1){\n        }\n    }\n}\n\n"]}