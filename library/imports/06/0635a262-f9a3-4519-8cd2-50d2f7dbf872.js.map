{"version":3,"sources":["assets\\syyx_sdk\\controller\\ctr_test\\syyx_ctr_manager.ts"],"names":[],"mappings":";;;;;;;AAAA,iEAA2D;AAC3D,gDAA+C;AAC/C,2CAA8C;AAE9C;IAAA;IAqIA,CAAC;IA7GG;;MAEE;IACK,gCAAe,GAAtB;QAEI,IAAI,uBAAuB,GAAG,2BAAY,CAAC,wBAAwB,CAAA;QACnE,IAAI,OAAO,GAAG,EAAE,CAAA;QAChB,IAAI,QAAQ,GAAG,EAAE,CAAA;QACjB,IAAI,IAAI,GAAG,IAAI,CAAA;QAEf,IAAG,uBAAuB,CAAC,MAAM,GAAG,CAAC,EAAE;YACnC,KAAc,UAAuB,EAAvB,mDAAuB,EAAvB,qCAAuB,EAAvB,IAAuB,EAAE;gBAAlC,IAAI,CAAC,gCAAA;gBACN,IAAI,CAAC,CAAC,IAAI,IAAI,MAAM,EAAE;oBAClB,OAAO,GAAG,CAAC,CAAC,IAAI,CAAC;oBACjB,QAAQ,GAAG,CAAC,CAAC,SAAS,CAAA,CAAC,UAAU;oBACjC,IAAI,CAAC,uBAAuB,GAAG,CAAC,CAAC,WAAW,CAAA;oBAC5C,MAAM;iBACT;aACJ;SACJ;QAED,IAAI,OAAO,GAAG;YACV,IAAI,EAAE,OAAO;YACb,WAAW,EAAE,QAAQ;YACrB,6BAA6B;SAChC,CAAA;QAED,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAA;IAC1D,CAAC;IAED;;OAEG;IACI,4BAAW,GAAlB,UAAmB,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI;QACtC,IAAI,GAAG,KAAK,IAAI,EAAE;YACd,qBAAqB;YACrB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA;YAChC,YAAY,CAAC,OAAO,CAAC,4BAAU,CAAC,wBAAwB,EAAE,OAAO,CAAC,CAAC;YACnE,YAAY,CAAC,OAAO,CAAC,4BAAU,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC;YAC7D,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAA;SAClC;aACI;YACD,IAAI,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,4BAAU,CAAC,qBAAqB,CAAC,CAAA;YACtE,IAAI,SAAS,EAAE;gBACX,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAA;aAClC;SACJ;QACD,OAAO,CAAC,GAAG,CAAC,+BAA+B,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA,CAAC,qBAAqB;IACrF,CAAC;IAED;;OAEG;IACI,uCAAsB,GAA7B;QACI,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAA;IAClC,CAAC;IAED;;OAEG;IACI,4CAA2B,GAAlC;QACI,OAAO,IAAI,CAAC,kBAAkB,CAAA;IAClC,CAAC;IAED;;OAEG;IACI,kCAAiB,GAAxB,UAAyB,SAAU;QAE/B,IAAI,IAAI,CAAC,kBAAkB,EAAE;YACzB,OAAO,CAAC,GAAG,CAAC,2CAA2C,CAAC,CAAA;YACxD,OAAM;SACT;QAED,IAAI,IAAI,CAAC,aAAa,EAAE,EAAE,EAAE,qBAAqB;YAC7C,2BAAY,CAAC,SAAS,CAAC,iBAAS,CAAC,QAAQ,EAAE,UAAU,IAAI;gBACrD,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;YAC7C,CAAC,CAAC,CAAA;SACL;IACL,CAAC;IAEM,wCAAuB,GAA9B;QACI,IAAI,qBAAqB,GAAG,2BAAY,CAAC,mBAAmB,EAAE,CAAA;QAC9D,IAAI,qBAAqB,IAAI,qBAAqB,CAAC,uBAAuB,CAAC,EAAE;YACzE,OAAO,qBAAqB,CAAC,uBAAuB,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;SACjE;QACD,OAAO,GAAG,CAAA;IACd,CAAC;IAED;;OAEG;IACI,8BAAa,GAApB;QACI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,CAAC,EAAE,EAAE,qBAAqB;YACxE,OAAO,IAAI,CAAA;SACd;QACD,OAAO,CAAC,GAAG,CAAC,oCAAoC,CAAC,CAAA;QACjD,OAAO,KAAK,CAAA;IAChB,CAAC;IAED;;OAEG;IACI,6BAAY,GAAnB;QACI,IAAI,IAAI,CAAC,aAAa,EAAE,EAAE;YACtB,OAAO,IAAI,CAAC,QAAQ,CAAA;SACvB;QACD,OAAO,SAAS,CAAA;IACpB,CAAC;IAlID;;OAEG;IACI,8BAAa,GAAG,eAAe,CAAC;IAEvC;;OAEG;IACI,oCAAmB,GAAG,KAAK,CAAC;IAEnC;;OAEG;IACI,yBAAQ,GAAG,IAAI,CAAA;IAEf,wCAAuB,GAAG,EAAE,CAAA;IAEnC;;MAEE;IACK,mCAAkB,GAAG,KAAK,CAAA;IA+GrC,uBAAC;CArID,AAqIC,IAAA;AArIY,4CAAgB","file":"","sourceRoot":"/","sourcesContent":["import { syyx_const } from \"../../configs/syyx_sdk_config\";\r\nimport { syyx_manager } from \"../syyx_manager\";\r\nimport { syyx_view } from '../../model/model';\r\n\r\nexport class syyx_ctr_manager {\r\n\r\n    /**\r\n     * 远端配置版本号\r\n     */\r\n    static __ctr_version = \"__ctr_version\";\r\n\r\n    /**\r\n     *远端配置拉取成功\r\n     */\r\n    static __remote_ctr_inited = false;\r\n\r\n    /**\r\n     *  配置表\r\n     */\r\n    static ctr_data = null\r\n\r\n    static new_product_location_id = ''\r\n\r\n    /**\r\n     *  超能力测试完毕\r\n    */\r\n    static ctr_test_compelete = false\r\n\r\n    /**\r\n    * 加载超能力测试配置\r\n    */\r\n    static load_ctr_config() {\r\n\r\n        let guobao_new_product_data = syyx_manager._guobao_init_config_data\r\n        let seldads = []\r\n        let gc_statu = ''\r\n        let self = this\r\n\r\n        if(guobao_new_product_data.length > 0) {\r\n            for (let i of guobao_new_product_data) {\r\n                if (i.type == \"self\") {\r\n                    seldads = i.data;\r\n                    gc_statu = i.gc_status // 0关闭，1开启\r\n                    self.new_product_location_id = i.location_id \r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        let ctrdata = {\r\n            list: seldads,\r\n            open_switch: gc_statu\r\n            // open_switch: 0 // 0 关闭，1开启\r\n        }\r\n\r\n        this.on_load_ctr(true, '', 5, JSON.stringify(ctrdata))\r\n    }\r\n\r\n    /**\r\n     *  远端超能力配置返回 \r\n     */\r\n    static on_load_ctr(ret, key, version, data) {\r\n        if (ret === true) {\r\n            //把数据和返回的version 保存本地\r\n            this.ctr_data = JSON.parse(data)\r\n            localStorage.setItem(syyx_const.local_ctr_config_version, version);\r\n            localStorage.setItem(syyx_const.local_ctr_config_data, data);\r\n            this.__remote_ctr_inited = true\r\n        }\r\n        else {\r\n            let save_data = localStorage.getItem(syyx_const.local_ctr_config_data)\r\n            if (save_data) {\r\n                this.__remote_ctr_inited = true\r\n            }\r\n        }\r\n        console.log(\"sdk--新品----- syyx_ctr_manager\", this.ctr_data) // open_switch 有 list\r\n    }\r\n\r\n    /**\r\n     * 测试完毕\r\n     */\r\n    static set_ctr_test_compelete() {\r\n        this.ctr_test_compelete = true\r\n    }\r\n\r\n    /**\r\n     * 是否测试完毕\r\n     */\r\n    static check_is_ctr_test_compelete() {\r\n        return this.ctr_test_compelete\r\n    }\r\n\r\n    /**\r\n     * 展示新品尝鲜\r\n     */\r\n    static show_new_products(call_back?) {\r\n\r\n        if (this.ctr_test_compelete) {\r\n            console.log(\"igc----- syyx_ctr_manager test compelete!\")\r\n            return\r\n        }\r\n\r\n        if (this.check_is_open()) { // 根据国宝数据，gc_statuc判断\r\n            syyx_manager.load_view(syyx_view.ctr_test, function (view) {\r\n                view && view.show && view.show(call_back)\r\n            })\r\n        }\r\n    }\r\n\r\n    static get_new_products_reward() {\r\n        let _business_config_data = syyx_manager.get_business_config()\r\n        if (_business_config_data && _business_config_data[\"ctr_test_reward_count\"]) {\r\n            return _business_config_data[\"ctr_test_reward_count\"].value[0]\r\n        }\r\n        return 100\r\n    }\r\n\r\n    /**\r\n     * 是否开启新品尝鲜\r\n     */\r\n    static check_is_open() {\r\n        if (this.ctr_data && this.ctr_data.open_switch == 1) { // 根据国宝数据，gc_statuc判断\r\n            return true\r\n        }\r\n        console.log(\"igc----- syyx_ctr_manager is close\")\r\n        return false\r\n    }\r\n\r\n    /**\r\n     * 获取ctr配置数据\r\n     */\r\n    static get_ctr_data() {\r\n        if (this.check_is_open()) {\r\n            return this.ctr_data\r\n        }\r\n        return undefined\r\n    }\r\n}\r\n\r\n\r\n"]}