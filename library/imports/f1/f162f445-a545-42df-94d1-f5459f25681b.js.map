{"version":3,"sources":["assets\\scripts\\game\\ui\\bossHp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { caijiTools } from \"../../caijiTools\";\nimport { data } from \"../../sdk/data\";\nimport { enemyAttribute } from \"../enemyBase\";\n\nconst { ccclass, property } = cc._decorator;\nexport enum bossName {\n    enemy10 = \"enemy10\",\n    enemy39=\"enemy39\",\n    miniBoss=\"miniBoss\"\n}\n@ccclass\nexport default class bossHp extends cc.Component {\n\n    @property(cc.ProgressBar)\n    hpBar: cc.ProgressBar = null;\n    @property(cc.Sprite)\n    headIcon: cc.Sprite = null;\n    @property(cc.Label)\n    hpNumLabel: cc.Label = null;\n    @property(cc.Node)\n    nowHpNode: cc.Node = null;\n    @property(cc.Node)\n    nextHpNode: cc.Node = null;\n\n    hpMax:number=0;\n    barWidth:number=0;\n    bossName: string = \"\";\n    hpNum: number = 5;//血条剩余量\n    hp: number = 0;//血量\n    everyValue: number = 0;//每条血条的血量\n    acitonSpeed:number=0.8;//血条削减动画速度\n    hpBarShadow:cc.Node=null;//血条削减影子\n    hpBarNode:cc.Node=null;//血条\n    isLockAction:boolean=false;\n\n    onLoad () {\n        this.hpBarShadow=this.nowHpNode.children[0];\n        this.hpBarNode=this.nowHpNode.children[1];\n    }\n    update(){\n        this.hpBarShadow.width=cc.misc.lerp(this.hpBarShadow.width,this.hpBarNode.width,0.06);\n    }\n    init(func) {\n        this.barWidth=this.hpBar.totalLength;\n        this.hpMax = Number(data.gameJson(\"enemyData\", this.bossName, enemyAttribute.hp));\n        this.hp=this.hpMax;\n        this.hpNum = 5;\n        this.everyValue = this.hp / this.hpNum;\n        this.updateHpNum();\n        this.updateHeadIcon(func);\n        this.updateNowHpBar();\n        this.updateNextHpBar();\n    }\n    updateNowHpBar() {\n        this.hpBar.progress=1;\n        this.nowHpNode.children[0].width=this.barWidth;\n        this.nowHpNode.children[1].width=this.barWidth;\n        this.nowHpNode.children[0].color=this.hpBarColor[this.hpNum][\"color\"];\n        this.nowHpNode.children[1].color=this.hpBarColor[this.hpNum][\"colorDark\"];\n    }\n    updateNextHpBar() {\n        if (this.hpNum == 1) {\n            this.nextHpNode.children[0].opacity=0;\n        }else{\n            this.nextHpNode.children[0].color=this.hpBarColor[this.hpNum-1][\"colorDark\"];\n        }\n    }\n    addHp(addValue: number) {\n        addValue=Math.floor(addValue);\n        this.hp += addValue;\n        if(this.hp<=0){\n            //死亡\n            this.hpNumLabel.string =\"x0\";\n            this.hpBarToZeroAction(false);\n            return;\n        }\n        this.hp=this.hp>this.hpMax?this.hpMax:this.hp;\n        if(this.isLockAction) return;\n        let nowHpNum=Math.ceil(this.hp/this.everyValue);\n        if(nowHpNum<this.hpNum){\n            this.hpBarToZeroAction(); \n        }else{\n            this.hpBarAction();\n        }\n    }\n    //进入下一血条\n    enterNextHp() {\n        this.isLockAction=false;\n        this.hpNum--;\n        this.updateHpNum();\n        this.updateNowHpBar();\n        this.updateNextHpBar();\n        this.hpBarAction();\n    }\n    hpBarAction(){\n        cc.Tween.stopAllByTarget(this.hpBar);\n        let nowProgress=this.hpBar.progress;\n        let toProgress=(this.hp%this.everyValue)/this.everyValue;\n        toProgress=toProgress==0?1:toProgress;\n        let time=(nowProgress-toProgress)/this.acitonSpeed;\n        cc.tween(this.hpBar)\n        .to(time,{progress:toProgress},{easing:\"quadOut\"})\n        .start();\n    }\n    hpBarToZeroAction(isEnterNextHp:boolean=true){\n        this.isLockAction=true;\n        cc.Tween.stopAllByTarget(this.hpBar);\n        let nowProgress=this.hpBar.progress;\n        let time=nowProgress/this.acitonSpeed*0.5;\n        cc.tween(this.hpBar)\n        .to(time,{progress:0},{easing:\"quadOut\"})\n        .call(()=>{\n            if(isEnterNextHp==false) return;\n            this.enterNextHp();\n        })\n        .start();\n    }\n    //增加血条\n    increseHpNum(){\n\n    }\n    updateHpNum() {\n        this.hpNumLabel.string =\"x\"+ this.hpNum.toString();\n    }\n    async updateHeadIcon(func) {\n        let icon = await caijiTools.loadSpriteFrame(\"bossHead/\" + this.bossName);\n        this.headIcon.spriteFrame = icon;\n        this.headIcon.node.setPosition(this.headIconPosition[this.bossName]);\n        func();\n    }\n    headIconPosition = {\n        \"enemy10\": cc.v2(-16, -42.5),\n        \"enemy39\": cc.v2(-6, -42.5),\n        \"miniBoss\": cc.v2(-13.4, -60)\n    }\n    hpBarColor={\n        5:{\n            color:cc.color(158, 24, 196),\n            colorDark:cc.color(99, 0, 127)\n        },\n        4:{\n            color:cc.color(95, 108, 237),\n            colorDark:cc.color(0, 12, 129)\n        },\n        3:{\n            color:cc.color(53, 168, 94),\n            colorDark:cc.color(18, 94, 45)\n        },\n        2:{\n            color:cc.color(152, 146, 42),\n            colorDark:cc.color(113, 108, 27)\n        },\n        1:{\n            color:cc.color(172, 0, 29),\n            colorDark:cc.color(113, 0, 19)\n        }\n    }\n}\n"]}