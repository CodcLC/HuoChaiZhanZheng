{"version":3,"sources":["assets\\scripts\\sdk\\_vivo.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { native, param } from \"./type\";\nconst TAG = '_vivo.ts';\nclass _vivo {\n    private static Instance: _vivo;\n    private videoId: string = \"\";\n    private bannerId: string = \"\";\n    private insertId: string = \"\";\n    private nativeId: string = \"\";\n    private videoAd: any = null;\n    private bannerAd: any = null;\n    private OnVideoCallBackListener: Function = null;\n    private sdkInitEnd: boolean = false;\n    private showAdLastTime: number = 0;\n    constructor() {\n        console.log(TAG, 'init platform channel: vivo_play');\n    }\n    public static getInstance(): _vivo {\n        if (this.Instance == null) {\n            this.Instance = new _vivo();\n        }\n        return this.Instance;\n    }\n    initAdParams(param: param) {\n        if (this.sdkInitEnd) {\n            return;\n        }\n        this.sdkInitEnd = true;\n        this.insertId = param.insertId;\n        this.bannerId = param.bannerId;\n        this.videoId = param.videoId;\n        this.nativeId = param.nativeId;\n        this.initBannderAd();\n    }\n    initBannderAd() {\n        //@ts-ignore\n        let bannerAd = qg.createBannerAd({\n            posId: this.bannerId,\n            style: {}\n        });\n        this.bannerAd = bannerAd;\n        this.bannerAd.onError((err: any) => {\n            console.warn(TAG, `banner广告加载失败:${JSON.stringify(err)}`);\n        });\n    }\n    bannerAd_show() {\n        if (this.bannerAd) {\n            this.bannerAd.show();\n        }\n    }\n    bannerAd_hide() {\n        if (this.bannerAd) {\n            this.bannerAd.hide();\n            this.bannerAd.destroy();\n            this.initBannderAd();\n        }\n    }\n    initVideoAd() {\n        //@ts-ignore\n        this.videoAd = qg.createRewardedVideoAd({\n            posId: this.videoId\n        });\n        this.videoAd.onLoad(() => {\n            cc.audioEngine.pauseAll();\n            this.videoAd.show();\n            this.showAdLastTime = new Date().getTime();\n        });\n        this.videoAd.onClose((res: any) => {\n            cc.audioEngine.resumeAll();\n            if (res && res.isEnded) {\n                this.OnVideoCallBackListener(true);\n            } else {\n                this.OnVideoCallBackListener(false);\n            }\n        });\n        this.videoAd.onError((err: any) => {\n            console.warn(TAG, `视频广告错误:${JSON.stringify(err)}`);\n        });\n        this.videoAd.load();\n    }\n    videoAd_show(OnVideoCall: Function) {\n        let now: number = new Date().getTime();\n        if (now - this.showAdLastTime < 60000) {\n            //@ts-ignore\n            qg.showToast({\n                message: '每分钟只能看一次视频'\n            });\n            return;\n        }\n        this.OnVideoCallBackListener = OnVideoCall;\n        this.videoAd != null ? this.videoAd.load() : this.initVideoAd();\n    }\n    insertAd_show() {\n        // @ts-ignore\n        var interstitialAd = qg.createInterstitialAd({\n            posId: this.insertId\n        });\n        interstitialAd.onError((err: any) => {\n            console.warn(TAG, `插屏广告错误:${JSON.stringify(err)}`);\n        });\n        interstitialAd.show();\n    }\n    shakeDevice() {\n        // @ts-ignore\n        qg.vibrateShort();\n    }\n    nativeAdShow(cb: native) {\n        // @ts-ignore\n        let nativeAd = qg.createNativeAd({\n            posId: this.nativeId,\n        });\n        nativeAd.onLoad((res: any) => {\n            console.log(TAG, `原生广告加载完成-onload触发:${JSON.stringify(res)}`);\n            let nativeCurrentAd: any = null;\n            if (res && res.adList) {\n                nativeCurrentAd = res.adList.pop();\n                ///> 上报曝光\n                nativeAd.reportAdShow({ adId: nativeCurrentAd[\"adId\"] });\n                ///> 上报点击\n                let tempClick: Function = () => {\n                    console.log(TAG, '_vivo 原生点击');\n                    nativeAd.reportAdClick({ adId: nativeCurrentAd[\"adId\"] });\n                }\n                //展示广告\n                if (nativeCurrentAd[\"icon\"] != null && nativeCurrentAd[\"imgUrlList\"][0] != null) {\n                    cb(nativeCurrentAd[\"icon\"], nativeCurrentAd[\"imgUrlList\"][0], tempClick);\n                }\n            }\n        });\n        nativeAd.onError((err: any) => {\n            switch (err.errCode) {\n                case -3:\n                    console.log(TAG, `原生广告加载失败---调用太频繁:${JSON.stringify(err)}`);\n                    break;\n                default:\n                    console.log(TAG, `原生广告加载异常:${JSON.stringify(err)}`);\n                    break;\n            }\n        });\n        nativeAd.load().then(() => {\n            console.log(TAG, `VIVO原生加载成功`);\n        }).catch((err: any) => {\n            console.warn(TAG, `VIVO原生加载失败:${JSON.stringify(err)}`);\n        });\n    }\n}\nexport const ch_vivo = _vivo;\n"]}