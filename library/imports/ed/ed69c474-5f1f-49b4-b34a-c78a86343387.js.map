{"version":3,"sources":["assets\\scripts\\game\\arrow.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAElF,4CAA2C;AAC3C,uDAAkD;AAE5C,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAmC,yBAAY;IAA/C;QAAA,qEAuEC;QArEG,WAAK,GAAQ,IAAI,CAAC;QAClB,YAAM,GAAQ,CAAC,CAAC;QAChB,YAAM,GAAC,EAAC,GAAG,EAAC,CAAC,EAAC,CAAC;QACf,YAAM,GAAQ,CAAC,CAAC;QAChB,OAAC,GAAQ,CAAC,CAAC;QACX,WAAK,GAAS,IAAI,CAAC;QACnB,WAAK,GAAS,KAAK,CAAC;QACpB,gBAAU,GAAS,KAAK,CAAC;QACzB,cAAQ,GAAc,IAAI,CAAC;QAC3B,UAAI,GAAQ,CAAC,CAAC;QACd,oBAAc,GAAS,IAAI,CAAC;;IA2DhC,CAAC;IAzDG,sBAAM,GAAN;QACI,IAAI,CAAC,QAAQ,GAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;IACvD,CAAC;IACD,qBAAK,GAAL;QAAA,iBAcC;QAbG,IAAI,MAAM,GAAC,uBAAU,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAC,EAAE,CAAC,CAAC,aAAa,EAAE,CAAC;QACvE,IAAI,CAAC,MAAM,GAAC,MAAM,CAAC,CAAC,GAAC,IAAI,CAAC,KAAK,CAAC;QAChC,IAAI,CAAC,MAAM,CAAC,GAAG,GAAC,MAAM,CAAC,CAAC,GAAC,IAAI,CAAC,KAAK,CAAC;QACpC,IAAI,CAAC,IAAI,GAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,GAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC5E,IAAI,CAAC,IAAI,GAAC,IAAI,CAAC,IAAI,GAAC,IAAI,CAAA,CAAC,CAAA,IAAI,CAAC,IAAI,GAAC,IAAI,CAAA,CAAC,CAAA,IAAI,CAAC,IAAI,GAAC,IAAI,CAAC;QACvD,IAAI,CAAC,CAAC,GAAC,IAAI,CAAC,MAAM,CAAC,GAAG,GAAC,CAAC,GAAC,IAAI,CAAC,IAAI,CAAC,CAAA,UAAU;QAC7C,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC;aACpB,EAAE,CAAC,IAAI,CAAC,IAAI,EAAC,EAAC,GAAG,EAAC,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,EAAC,CAAC;aACpC,IAAI,CAAC;YACF,KAAI,CAAC,UAAU,GAAC,IAAI,CAAC;QACzB,CAAC,CAAC;aACD,KAAK,EAAE,CAAC;IAEb,CAAC;IACD,sBAAM,GAAN,UAAO,EAAE;QACL,IAAG,IAAI,CAAC,KAAK;YAAE,OAAO;QACtB,IAAG,IAAI,CAAC,UAAU,EAAC;YACf,IAAI,CAAC,MAAM,CAAC,GAAG,IAAE,IAAI,CAAC,CAAC,GAAC,EAAE,GAAC,GAAG,CAAC;SAClC;QACD,IAAI,CAAC,QAAQ,CAAC,cAAc,GAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,EAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QAChE,IAAI,cAAc,GAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC;QAChD,IAAI,KAAK,GAAC,uBAAU,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,EAAC,cAAc,CAAC,CAAC,CAAC,CAAC;QACxE,IAAI,CAAC,IAAI,CAAC,KAAK,GAAC,CAAC,KAAK,GAAC,EAAE,CAAC;IAC9B,CAAC;IACD,gCAAgB,GAAhB,UAAiB,KAAiB,EAAC,IAAgB;QAC/C,IAAG,KAAK,CAAC,IAAI,CAAC,KAAK,IAAE,QAAQ,EAAC;YAC1B,IAAG,IAAI,CAAC,KAAK;gBAAE,OAAO;YACtB,IAAI,CAAC,KAAK,GAAC,IAAI,CAAC;YAChB,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,0BAAgB,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAC3E;IACL,CAAC;IACD,8BAAc,GAAd,UAAe,OAA0B,EAAE,YAAgC,EAAE,aAAiC;QAA9G,iBAWC;QAVG,IAAI,KAAK,GAAG,aAAa,CAAC,IAAI,CAAC;QAC/B,IAAI,KAAK,CAAC,KAAK,IAAI,QAAQ,EAAE;YACzB,IAAI,CAAC,KAAK,GAAC,IAAI,CAAC;YAChB,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAI,CAAC,QAAQ,CAAC,cAAc,GAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC,GAAC,GAAG,EAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC,GAAC,GAAG,CAAC,CAAC;YAC1G,IAAI,CAAC,YAAY,CAAC;gBACd,KAAI,CAAC,QAAQ,CAAC,cAAc,GAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;gBACxC,KAAI,CAAC,QAAQ,CAAC,IAAI,GAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC;YAC/C,CAAC,EAAC,CAAC,CAAC,CAAC;SACR;IACL,CAAC;IACD,uBAAO,GAAP;QAAA,iBASC;QARG,IAAI,CAAC,YAAY,CAAC;YACd,EAAE,CAAC,KAAK,CAAC,KAAI,CAAC,IAAI,CAAC;iBAClB,EAAE,CAAC,GAAG,EAAC,EAAC,OAAO,EAAC,CAAC,EAAC,CAAC;iBACnB,IAAI,CAAC;gBACF,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YACxB,CAAC,CAAC;iBACD,KAAK,EAAE,CAAC;QACb,CAAC,EAAC,CAAC,CAAC,CAAC;IACT,CAAC;IAtEgB,KAAK;QADzB,OAAO;OACa,KAAK,CAuEzB;IAAD,YAAC;CAvED,AAuEC,CAvEkC,EAAE,CAAC,SAAS,GAuE9C;kBAvEoB,KAAK","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport { caijiTools } from \"../caijiTools\";\nimport playerController from \"./playerController\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class arrow extends cc.Component {\n\n    force:number=1800;\n    speedX:number=0;\n    speedY={num:0};\n    damage:number=0;\n    a:number=0;\n    enemy:cc.Node=null;\n    isHit:boolean=false;\n    isTweenEnd:boolean=false;\n    rigibody:cc.RigidBody=null;\n    time:number=0;\n    playerPosition:cc.Vec2=null;\n\n    onLoad(){\n        this.rigibody=this.node.getComponent(cc.RigidBody);\n    }\n    start(){\n        let direct=caijiTools.getDirection(this.node.angle+90).normalizeSelf();\n        this.speedX=direct.x*this.force;\n        this.speedY.num=direct.y*this.force;\n        this.time=Math.abs(this.playerPosition.x-this.node.x)/Math.abs(this.speedX);\n        this.time=this.time<0.15?this.time-0.06:this.time-0.09;\n        this.a=this.speedY.num*2/this.time;//v1=v0-at\n        cc.tween(this.speedY)\n        .to(this.time,{num:-this.speedY.num})\n        .call(()=>{\n            this.isTweenEnd=true;\n        })\n        .start();\n\n    }\n    update(dt){\n        if(this.isHit) return;\n        if(this.isTweenEnd){\n            this.speedY.num-=this.a*dt*0.9;\n        }\n        this.rigibody.linearVelocity=cc.v2(this.speedX,this.speedY.num);\n        let linearVelocity=this.rigibody.linearVelocity;\n        let angle=caijiTools.getAngleDependY(linearVelocity.x,linearVelocity.y);\n        this.node.angle=-angle-90;\n    }\n    onCollisionEnter(other:cc.Collider,self:cc.Collider){\n        if(other.node.group==\"player\"){\n            if(this.isHit) return;\n            this.isHit=true;\n            other.node.getComponent(playerController).beHit(this.enemy,this.damage);\n        }\n    }\n    onBeginContact(contact: cc.PhysicsContact, selfCollider: cc.PhysicsCollider, otherCollider: cc.PhysicsCollider) {\n        let other = otherCollider.node;\n        if (other.group == \"ground\") {\n            this.isHit=true;\n            this.Destroy();\n            this.rigibody.linearVelocity=cc.v2(this.rigibody.linearVelocity.x*0.3,this.rigibody.linearVelocity.y*0.3);\n            this.scheduleOnce(()=>{\n                this.rigibody.linearVelocity=cc.v2(0,0);\n                this.rigibody.type=cc.RigidBodyType.Static;\n            },0);\n        }\n    }\n    Destroy(){\n        this.scheduleOnce(()=>{\n            cc.tween(this.node)\n            .to(0.3,{opacity:0})\n            .call(()=>{\n                this.node.destroy();\n            })\n            .start();\n        },1);\n    }\n}\n"]}