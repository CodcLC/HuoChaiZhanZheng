{"version":3,"sources":["assets\\scripts\\game\\enemySpawn.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport { caijiTools } from \"../caijiTools\";\nimport { data } from \"../sdk/data\";\nimport GameManager from \"./GameManager\";\nimport spawnEnemy from \"./spawnEnemy\";\n\nconst {ccclass, property} = cc._decorator;\n\nenum enemySpwanData{\n    wave=\"wave\",\n    amount=\"amount\",\n    enemyNames=\"enemyNames\"\n}\n@ccclass\nexport default class enemySpawn extends cc.Component {\n\n    nowLevel:number=0;\n    difficulty:number=0;\n    levelData:any=null;\n    waveInterval:number=0;\n    wave:number=0;\n    amount:number=0;\n    enemyNames:string[]=[];\n    spawnEnemyIntervalMin:number=0.8;\n    spawnEnemyIntervalMax:number=1.5;\n\n    hadSpwanWave:number=0;\n    hadSpwanAmount:number=0;\n    onLoad () {\n        this.init();\n    }\n\n    start () {\n    }\n    init(){\n        GameManager.instance.enemySpawnM=this;\n        this.nowLevel=Number(data.getCache(\"Base\",\"choseLevel\"));\n        this.difficulty=Number(data.getCache(\"levelStar\",this.nowLevel.toString()));\n        this.waveInterval=Number(data.gameJson(\"waveInterval\"));\n        this.levelData=data.gameJson(\"levelData\",this.nowLevel.toString());\n        this.wave=this.levelData[\"enemySpawn\"][enemySpwanData.wave];\n        this.amount=this.levelData[\"enemySpawn\"][enemySpwanData.amount];\n        this.enemyNames=this.levelData[\"enemySpawn\"][enemySpwanData.enemyNames];\n        GameManager.instance.needKillEnemyAmount=this.wave*this.amount[this.difficulty];\n    }\n    startSpwan(){\n        this.hadSpwanWave++;\n        this.hadSpwanAmount=0;\n        this.scheduleSpawn();\n        \n        if(this.hadSpwanWave<this.wave){\n            this.scheduleOnce(()=>{\n                this.startSpwan();\n            },this.waveInterval+this.amount[this.difficulty]*1.5);\n        }\n    }\n    scheduleSpawn(){\n        this.hadSpwanAmount++;\n        console.log(this.hadSpwanAmount,this.hadSpwanWave,this.wave)\n        let name=this.enemyNames[caijiTools.random_int(0,this.enemyNames.length-1)];\n        this.scheduleOnce(()=>{\n            this.spawnEnemy(name);\n            if(this.hadSpwanAmount<this.amount[this.difficulty]){\n                this.scheduleSpawn();\n            }\n        },caijiTools.random_int(50,120)/100);\n    }\n    async spawnEnemy(enemyName:string){\n        let pre=await caijiTools.loadPrefab(\"prefabs/spawnEnemy\");\n        let spwanEffect=caijiTools.createNode(pre,this.node,false);\n        spwanEffect.setSiblingIndex(GameManager.instance.player.getSiblingIndex());\n        spwanEffect.getComponent(spawnEnemy).spawnEnemyName=enemyName;\n        let x=GameManager.instance.player.x+caijiTools.random_int(-cc.winSize.width/2,cc.winSize.width/2);\n        if(x<-300){\n            x=GameManager.instance.player.x+caijiTools.random_int(0,cc.winSize.width/2);\n        }else if(x>1600){\n            x=GameManager.instance.player.x+caijiTools.random_int(-cc.winSize.width/2,0);\n        }\n        spwanEffect.setPosition(x,-177);\n        spwanEffect.active=true;\n    }\n}\n"]}